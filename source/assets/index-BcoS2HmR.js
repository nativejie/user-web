import{f as p}from"./index-V84Tf6o4.js";import{p as m,g as d,a as c,c as u}from"./product-kYgfBKcQ.js";import{n as h,g as v}from"./index-C6rblSgp.js";import{b as _}from"./order-DUiBgAo_.js";import"./terms-ChenOVHG.js";const f={name:"Video",props:{src:{type:String,required:!0,default:""},poster:{type:String,default:""},second:{type:Number,default:.5},width:{type:Number,default:800},height:{type:Number,default:450},autoplay:{type:Boolean,default:!1},controls:{type:Boolean,default:!0},loop:{type:Boolean,default:!1},muted:{type:Boolean,default:!1},preload:{type:String,default:"metadata"},showPlay:{type:Boolean,default:!0},playWidth:{type:Number,default:96},zoom:{type:String,default:"contain"}},data(){return{veoPoster:this.poster,originPlay:!0,hidden:!1}},mounted(){this.autoplay&&(this.hidden=!0,this.originPlay=!1)},methods:{getPoster(){this.$refs.veo.currentTime=this.second;const a=document.createElement("canvas"),t=a.getContext("2d");a.width=this.$refs.veo.videoWidth,a.height=this.$refs.veo.videoHeight,t.drawImage(this.$refs.veo,0,0,a.width,a.height),this.veoPoster=a.toDataURL("image/png")},onPlay(){this.originPlay&&(this.$refs.veo.currentTime=0,this.originPlay=!1),this.autoplay?this.$refs.veo.pause():(this.hidden=!0,this.$refs.veo.play())},onPause(){this.hidden=!1},onPlaying(){this.hidden=!0}}};var y=function(){var t=this,e=t._self._c;return e("div",{staticClass:"m-video",class:{"u-video-hover":!t.hidden},style:`width: ${t.width}px; height: ${t.height}px;`},[e("video",t._b({ref:"veo",style:`object-fit: ${t.zoom};`,attrs:{src:t.src,poster:t.veoPoster,width:t.width,height:t.height,autoplay:t.autoplay,controls:!t.originPlay&&t.controls,loop:t.loop,preload:t.preload,crossorigin:"anonymous"},domProps:{muted:t.autoplay||t.muted},on:{loadeddata:function(s){t.poster||t.getPoster()},pause:function(s){t.showPlay&&t.onPause()},playing:function(s){t.showPlay&&t.onPlaying()},"~click":function(s){return s.preventDefault(),t.onPlay.apply(null,arguments)}}},"video",t.$attrs,!1),[t._v(" 您的浏览器不支持video标签。 ")]),e("svg",{directives:[{name:"show",rawName:"v-show",value:t.originPlay||t.showPlay,expression:"originPlay || showPlay"}],staticClass:"u-play",class:{hidden:t.hidden},style:`width: ${t.playWidth}px; height: ${t.playWidth}px;`,attrs:{viewBox:"0 0 24 24"}},[e("path",{attrs:{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"1.5",d:"M15.25 12L9.75 8.75V15.25L15.25 12Z"}})])])},g=[],b=h(f,y,g,!1,null,"7f508e47");const C=b.exports,w={name:"product",components:{footerBar:p,Video:C},data(){return{imageAct:0,imageUrl:"",videoUrl:"",mediaList:[],quantity:1,showIndex:0,multipleIdx:1,multiple:1,recommendList:[],Loading:!1,coverLayerStyle:{transform:""},coverLayerImg:{},coverLayerShow:!1,productDetail:"",skuDetail:"",attributeGroupValueVOs:[],poster:"",showSkuList:!1,stock:0,disabled:!0,elementContentList:"",totalStock:0}},watch:{stock:a=>{}},mounted(){this.elementContentList=window.elementContentList,this.getProDetail()},methods:{getProDetail(){const a={productUid:this.$route.query.uid};m(a).then(t=>{t.code==200&&(this.productDetail=t.data,this.recommendList=t.data.recFormVOs||[],this.stock=t.data.totalStock,this.totalStock=t.data.totalStock,this.mediaList=this.productDetail.picResourceVOs,this.mediaList.splice(1,0,t.data.videoResourceVOs[0]),this.poster=t.data.videoResourceVOs[0].masterPic,this.imageUrl=this.mediaList[0].preViewUrl,this.productDetail.attributeGroupValueVOs.map(e=>{let s=[];e.attributeValueVOS.forEach(o=>{let l={...o,check:!1};s.push(l)});let i={...e,attributeValueVOS:s};this.attributeGroupValueVOs.push(i)}),this.attributeGroupValueVOs.length==0||this.attributeGroupValueVOs.length==1&&this.attributeGroupValueVOs[0].attributeValueVOS.length<=1?(this.showSkuList=!1,this.handleChangeAttr2()):this.showSkuList=!0)})},getProSku(){const a={productBaseUid:0};proSku(a).then(t=>{})},enterHandler(){this.coverLayerShow=!0},moveHandler(a){let t=a.offsetX,e=a.offsetY,s=t-100<0?0:t-100,i=e-100<0?0:e-100;s>250&&(s=250),i>250&&(i=250),this.coverLayerStyle.transform=`translate(${s}px,${i}px)`,this.coverLayerImg.transform=`translate(-${s}px,-${i}px)`},outHandler(){this.coverLayerShow=!1},handleMinusIndx(){if(this.showIndex==1)return!1;this.showIndex=this.showIndex-4,this.multiple--},handleAddIndx(){if(this.showIndex==Math.ceil(this.recommendList.length/4))return!1;this.showIndex=this.showIndex+4,this.multiple++},handleChangeAttr2(){let a=[];this.attributeGroupValueVOs.forEach(e=>{e.attributeValueVOS.forEach(s=>{a.push(s.productAttributeValueUid)})});const t={productAttributeValueUidList:a,productBaseUid:this.productDetail.productBaseUid};d(t).then(e=>{}),c(t).then(e=>{this.skuDetail=e.data}),u(t).then(e=>{e.data?this.disabled=!1:this.disabled=!0})},handleBuyNow(){this.showSkuList||this.handleChangeAttr2();const a={productBaseUid:this.productDetail.productBaseUid,productSkuUid:this.skuDetail.productSkuStockUid,productUid:this.productDetail.productUid,quantity:this.quantity};_(a).then(t=>{t.code==200&&this.$router.push({path:"/settlement",query:{from:"now",params:JSON.stringify(t.data)}})})},handleAddToCart(){this.showSkuList||this.handleChangeAttr2();const a={productBaseUid:this.productDetail.productBaseUid,productSkuUid:this.skuDetail.productSkuStockUid,productUid:this.productDetail.productUid,quantity:this.quantity};v(a).then(t=>{t.code==200&&(this.$message.success({message:this.elementContentList.portal_product_text6||this.$t("product.text6"),duration:1500}),this.$store.dispatch("UpdateCartNum"))})},handleInput(){if(this.quantity=this.quantity.replace(/[^\d]/g,""),this.quantity<1)return this.quantity=""},handleMinusQty(){if(this.quantity<=1)return!1;this.quantity--},handleAddQty(){this.quantity++},handleChangeAttr(a,t,e,s){this.attributeGroupValueVOs[t].attributeValueVOS.forEach(r=>{r.productAttributeValueUid==e.productAttributeValueUid?r.check=!0:r.check=!1});let i=[],o=[];this.attributeGroupValueVOs.forEach(r=>{r.attributeValueVOS.forEach(n=>{n.check&&(i.push(n.productAttributeValueUid),o.push(n.check))})});const l={productAttributeValueUidList:i,productBaseUid:this.productDetail.productBaseUid};d(l).then(r=>{}),c(l).then(r=>{this.skuDetail=r.data,o.length==this.attributeGroupValueVOs.length?this.stock=r.data.realStock||0:this.stock=this.productDetail.realStock||this.totalStock}),u(l).then(r=>{r.data?this.disabled=!1:this.disabled=!0})},handleChangeImage(a,t){a.playUrl?(this.videoUrl=a.playUrl,this.imageUrl=""):(this.imageUrl=a.preViewUrl,this.videoUrl=""),this.imageAct=t}}};var k=function(){var t=this,e=t._self._c;return e("div",{staticClass:"product"},[e("div",{staticClass:"pro_container"},[e("div",{staticClass:"pro_basic_info"},[e("div",{staticClass:"image_info"},[e("div",{staticClass:"image_view"},[t.videoUrl?e("video",{attrs:{src:t.videoUrl,autoplay:"",controls:""}}):t._e(),t.imageUrl?e("img",{attrs:{src:t.imageUrl}}):t._e(),e("div",{directives:[{name:"show",rawName:"v-show",value:t.coverLayerShow&&t.imageUrl,expression:"coverLayerShow && imageUrl"}],staticClass:"coverLayerMouse",style:t.coverLayerStyle}),e("div",{directives:[{name:"show",rawName:"v-show",value:t.imageUrl,expression:"imageUrl"}],staticClass:"coverLayerMaskTop",on:{mouseenter:t.enterHandler,mousemove:t.moveHandler,mouseout:t.outHandler}}),e("div",{directives:[{name:"show",rawName:"v-show",value:t.coverLayerShow&&t.imageUrl,expression:"coverLayerShow && imageUrl"}],staticClass:"coverLayerRight"},[e("img",{staticClass:"coverLayerRightImg",style:t.coverLayerImg,attrs:{src:t.imageUrl,fit:"contain"}})])]),e("div",{staticClass:"image_list"},t._l(t.productDetail.picResourceVOs,function(s,i){return e("div",{key:i+"img",staticClass:"image_item",class:t.imageAct==i?"active":""},[s.playUrl?e("video",{attrs:{src:s.playUrl},on:{click:function(o){return t.handleChangeImage(s,i)}}}):e("img",{attrs:{src:s.thumbnailViewUrl},on:{click:function(o){return t.handleChangeImage(s,i)}}}),e("div",{staticClass:"active_border"})])}),0)]),e("div",{staticClass:"spec_info"},[e("p",{staticClass:"pro_title"},[t._v(t._s(t.productDetail.name))]),e("p",{staticClass:"unit_price"},[t._v(" £ "),e("span",[t._v(t._s(t.productDetail.price))])]),t._l(t.attributeGroupValueVOs,function(s,i){return e("div",{directives:[{name:"show",rawName:"v-show",value:t.showSkuList,expression:"showSkuList"}],key:i+"attribute"},[e("p",{staticClass:"spec_label"},[t._v(t._s(s.productAttributeName))]),e("div",{staticClass:"spec_color"},t._l(s.attributeValueVOS,function(o,l){return e("div",{key:o.productAttributeValueUid,staticClass:"spec_color_item flex_c_c",class:o.check==!0?"active":"",on:{click:function(r){return t.handleChangeAttr(s,i,o,l)}}},[e("span",[t._v(t._s(o.value))]),e("div",{staticClass:"active_border"})])}),0)])}),e("p",{staticClass:"spec_label"},[t._v(" "+t._s(t.elementContentList.portal_product_text1||t.$t("product.text1"))+" ")]),e("div",{staticStyle:{padding:"8px",border:"1px solid #dfe2e5","border-radius":"4px",width:"fit-content","min-width":"40px","text-align":"center"}},[t._v(" "+t._s(t.stock)+" ")]),e("p",{staticClass:"spec_label"},[t._v(" "+t._s(t.elementContentList.portal_product_text2||t.$t("product.text2"))+" ")]),e("p",{staticClass:"qty_btns flex"},[e("el-button",{staticClass:"btn",attrs:{icon:"el-icon-minus"},on:{click:t.handleMinusQty}}),e("el-input",{on:{input:t.handleInput},model:{value:t.quantity,callback:function(s){t.quantity=s},expression:"quantity"}}),e("el-button",{staticClass:"btn",attrs:{icon:"el-icon-plus"},on:{click:t.handleAddQty}})],1),e("p",{staticClass:"buy_btns"},[e("el-button",{staticClass:"btn",attrs:{disabled:t.disabled},on:{click:t.handleBuyNow}},[t._v(t._s(t.elementContentList.portal_product_btns_btn1||t.$t("product.btns.btn1")))]),e("el-button",{staticClass:"btn btn2",attrs:{disabled:t.disabled},on:{click:t.handleAddToCart}},[t._v(t._s(t.elementContentList.portal_product_btns_btn2||t.$t("product.btns.btn2")))])],1)],2)]),e("div",{staticClass:"pro_details_info"},[e("div",{staticClass:"pro_about"},[e("p",{staticClass:"pro_label"},[t._v(" "+t._s(t.elementContentList.portal_product_text3||t.$t("product.text3"))+" ")]),e("p",{staticClass:"pro_subtitle"},[t._v(" "+t._s(t.elementContentList.portal_product_text4||t.$t("product.text4"))+" ")]),e("div",{staticClass:"pro_desc"},t._l(t.productDetail.detailVOs,function(s,i){return e("p",{key:i+"detail"},[s.type=="word"?e("span",[t._v(t._s(s.detailDesc))]):e("img",{attrs:{src:s.detailImageUrl}})])}),0),t.recommendList.length>0?e("p",{staticClass:"pro_label"},[t._v(" "+t._s(t.elementContentList.portal_product_text5||t.$t("product.text5"))+" ")]):t._e(),t.recommendList.length>0?e("div",{staticClass:"recommend"},[e("div",{staticClass:"recommend_roll flex"},[t.recommendList.length>4?e("div",{staticClass:"to_left",class:t.multiple==1?"disabled":""},[e("i",{staticClass:"el-icon-arrow-left",on:{click:t.handleMinusIndx}})]):t._e(),e("div",{staticClass:"rec_list"},t._l(t.recommendList,function(s,i){return e("div",{directives:[{name:"show",rawName:"v-show",value:t.showIndex<=i,expression:"showIndex <= idx"}],key:i+"r",staticClass:"rec_item"},[e("div",{staticClass:"rec_iamge"},[e("img",{attrs:{src:s.masterPicUrl}})]),e("p",{staticClass:"rec_title"},[t._v(t._s(s.recProductName))]),e("div",{staticClass:"rec_label flex"}),e("div",{staticClass:"rec_btn flex_b_c"},[e("span",{staticClass:"price"},[t._v("£ "+t._s(s.price))]),e("el-button",{staticClass:"btn"},[t._v(t._s(t.elementContentList.portal_product_btns_btn2||t.$t("product.btns.btn2")))])],1)])}),0),t.recommendList.length>4?e("div",{staticClass:"to_right",class:t.multiple==Math.ceil(this.recommendList.length/4)?"disabled":"",on:{click:t.handleAddIndx}},[e("i",{staticClass:"el-icon-arrow-right"})]):t._e()])]):t._e()])])]),e("footerBar")],1)},V=[],x=h(w,k,V,!1,null,null);const D=x.exports;export{D as default};

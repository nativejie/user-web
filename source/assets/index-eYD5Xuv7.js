import{n as _,d as l,f as m,e as u,_ as f}from"./index-C6rblSgp.js";import{p as v,g as d,a as p,c as h}from"./product-kYgfBKcQ.js";import{_ as C}from"./noData-Cf3Dxh9O.js";const g={props:{productSKUDetail:{type:Object,default:()=>{}},productUid:{type:String,default:""},productQuantity:{type:Number,default:1},index:{type:Number,default:1}},data(){return{quantity:1,attributeGroupValueVOs:[],productDetail:"",imageUrl:"",elementContentList:"",stock:0,disabled:!1,skuDetail:"",loading:!1}},created(){this.elementContentList=window.elementContentList,this.quantity=this.productQuantity,this.getProDetail(),this.getskuStock()},methods:{getProDetail(){const s={productUid:this.productUid};v(s).then(t=>{t.code==200&&(this.productDetail=t.data,this.imageUrl=t.data.picResourceVOs[0].preViewUrl,this.productDetail.attributeGroupValueVOs.map(e=>{let i=[];e.attributeValueVOS.forEach(a=>{let r=!1;this.productSKUDetail.attributeValueVOs.map(o=>{a.productAttributeValueUid==o.productAttributeValueUid&&(r=!0)});let n={...a,check:r};i.push(n)});let c={...e,attributeValueVOS:i};this.attributeGroupValueVOs.push(c)}))})},getskuStock(){let s=[];this.productSKUDetail.attributeValueVOs.forEach(e=>{s.push(e.productAttributeValueUid)});const t={productAttributeValueUidList:s,productBaseUid:this.productSKUDetail.productBaseUid};d(t).then(e=>{}),p(t).then(e=>{this.skuDetail=e.data,this.stock=e.data.realStock}),h(t).then(e=>{e.data?this.disabled=!1:this.disabled=!0})},handleClose(){this.$parent.showProInfo=!1},handleConfirm(){this.loading=!0;const s={productBaseUid:this.productSKUDetail.productBaseUid,productSkuUid:this.skuDetail.productSkuStockUid,productUid:this.productUid,quantity:this.quantity};l(this.productSKUDetail.id,s).then(t=>{t.code==200?(this.$parent.showProInfo=!1,this.$message.success({message:this.elementContentList.portal_cart_msg4||this.$t("cart.msg4"),duration:1500}),this.$emit("changeSKUUid",this.skuDetail,this.quantity,this.index)):this.$message.success({message:t.message,duration:1500})})},handleChangeAttr(s,t,e,i){this.attributeGroupValueVOs[t].attributeValueVOS.forEach(n=>{n.productAttributeValueUid==e.productAttributeValueUid?n.check=!0:n.check=!1});let c=[],a=[];this.attributeGroupValueVOs.forEach(n=>{n.attributeValueVOS.forEach(o=>{o.check&&(c.push(o.productAttributeValueUid),a.push(o.check))})});const r={productAttributeValueUidList:c,productBaseUid:this.productDetail.productBaseUid};d(r).then(n=>{}),p(r).then(n=>{this.skuDetail=n.data,a.length==this.attributeGroupValueVOs.length?this.stock=n.data.realStock||0:this.stock=this.productDetail.realStock||this.totalStock}),h(r).then(n=>{n.data?this.disabled=!1:this.disabled=!0})},handleInput(){if(this.quantity=this.quantity.replace(/[^\d]/g,""),this.quantity<1)return this.quantity=1;if(this.quantity>=999)return this.quantity=999},handleMinusNum(){if(this.quantity<=1)return!1;this.quantity--},handleAddNum(){if(this.quantity>=999)return!1;this.quantity++}}};var b=function(){var t=this,e=t._self._c;return e("div",{staticClass:"productInfo flex_c_c"},[e("div",{staticClass:"info_card"},[e("p",{staticClass:"dia_title"},[t._v(" "+t._s(t.elementContentList.portal_order_text14||t.$t("order.text14"))),e("i",{staticClass:"el-icon-close",on:{click:t.handleClose}})]),e("div",{staticClass:"info_container"},[e("div",{staticClass:"info_left"},[e("div",{staticClass:"info_image"},[e("img",{attrs:{src:t.imageUrl}})])]),e("div",{staticClass:"info_right"},[e("p",{staticClass:"pro_title"},[t._v(" "+t._s(t.productDetail.name)+" ")]),e("p",{staticClass:"unit_price"},[t._v(" £ "),e("span",[t._v(t._s(t.productDetail.price))])]),t._l(t.attributeGroupValueVOs,function(i,c){return e("div",{key:c+"attribute"},[e("p",{staticClass:"spec_label"},[t._v(t._s(i.productAttributeName))]),e("div",{staticClass:"spec_color"},t._l(i.attributeValueVOS,function(a,r){return e("div",{key:a.productAttributeValueUid,staticClass:"spec_color_item flex",class:a.check==!0?"active":"",on:{click:function(n){return t.handleChangeAttr(i,c,a,r)}}},[e("span",[t._v(t._s(a.value))]),e("div",{staticClass:"active_border"})])}),0)])}),e("p",{staticClass:"spec_label"},[t._v(t._s(t.elementContentList.portal_product_text1||t.$t("product.text1")))]),e("div",{staticStyle:{padding:"8px",border:"1px solid #dfe2e5","border-radius":"4px",width:"fit-content","min-width":"40px","text-align":"center"}},[t._v(" "+t._s(t.stock)+" ")]),e("p",{staticClass:"spec_label"},[t._v(" "+t._s(t.elementContentList.portal_order_text33||t.$t("order.text33"))+" ")]),e("p",{staticClass:"qty_btns flex"},[e("el-button",{staticClass:"btn",attrs:{icon:"el-icon-minus"},on:{click:t.handleMinusNum}}),e("el-input",{on:{input:t.handleInput},model:{value:t.quantity,callback:function(i){t.quantity=i},expression:"quantity"}}),e("el-button",{staticClass:"btn",attrs:{icon:"el-icon-plus"},on:{click:t.handleAddNum}})],1),e("p",{staticClass:"buy_btns"},[e("el-button",{staticClass:"btn",attrs:{loading:t.loading,disabled:t.disabled},on:{click:t.handleConfirm}},[t._v(t._s(t.elementContentList.portal_btns_confirm||t.$t("btns.confirm")))])],1)],2)])])])},k=[],y=_(g,b,k,!1,null,null);const U=y.exports,L={name:"cart",components:{productInfo:U},data(){return{subtotal:1,priceTotal:0,cartList:[],checkedList:[],productUid:"",productQuantity:"",showProInfo:!1,elementContentList:"",isOpen:!1,productSKUDetail:"",index:"",typeArr:[]}},mounted(){this.elementContentList=window.elementContentList,this.getCartList()},methods:{changeSKUUid(s,t,e){this.cartList[e].attributeValueVOs=s.attributeValueVOs,this.cartList[e].priceTotal=s.attributeValueVOs,this.cartList[e]={...this.cartList[e],...s,productSkuUid:s.productSkuStockUid,priceTotal:s.price*t,quantity:t}},handleEdit(s,t){this.productUid=s.productUid,this.productQuantity=s.quantity,this.productSKUDetail=s,this.index=t,this.showProInfo=!0},getCartList(){m({pageNum:1,pageSize:1e3}).then(s=>{if(s.code==200){let t=[];s.data.list.map(e=>{let i={...e,priceTotal:e.price*e.quantity,check:!1};t.push(i)}),this.cartList=t,this.getPriceTotal()}})},handleToCheckout(){let s=!1;this.typeArr.length>1&&(s=!0),this.$router.push({path:"/settlement",query:{from:"cart",cartIds:JSON.stringify(this.checkedList),isGroup:s}})},handleChange(){let s=[],t=[];this.cartList.forEach(e=>{e.check&&(s.push(Number(e.id)),t.push(e.productType))}),this.checkedList=s,this.typeArr=[...new Set(t)],this.getPriceTotal()},getPriceTotal(){let s=0;this.cartList.forEach(t=>{t.check&&(s=s+t.quantity*t.price)}),this.priceTotal=s},handleMinusNum(s,t){if(this.cartList[s].quantity<=1)return!1;const e={productBaseUid:t.productBaseUid,productSkuUid:t.productSkuUid,productUid:t.productUid,quantity:t.quantity--};l(t.id,e).then(i=>{i.code==200?(this.cartList[s].quantity--,this.cartList[s].priceTotal=this.cartList[s].quantity*this.cartList[s].price,this.cartList[s].check&&this.getPriceTotal()):this.$message.success({message:i.message,duration:1500})})},handleAddNum(s,t){if(this.cartList[s].quantity>=999)return!1;const e={productBaseUid:t.productBaseUid,productSkuUid:t.productSkuUid,productUid:t.productUid,quantity:t.quantity++};l(t.id,e).then(i=>{i.code==200?(this.cartList[s].quantity++,this.cartList[s].priceTotal=this.cartList[s].quantity*this.cartList[s].price,this.cartList[s].check&&this.getPriceTotal()):this.$message.success({message:i.message,duration:1500})})},handleInput(s,t){if(this.cartList[s].quantity=this.cartList[s].quantity.replace(/[^\d]/g,""),this.cartList[s].quantity<1)return this.cartList[s].quantity=1,!1;if(this.cartList[s].quantity>=999)return this.cartList[s].quantity=999,!1;const e={productBaseUid:t.productBaseUid,productSkuUid:t.productSkuUid,productUid:t.productUid,quantity:t.quantity};l(t.id,e).then(i=>{i.code==200?(this.cartList[s].priceTotal=this.cartList[s].quantity*this.cartList[s].price,this.cartList[s].check&&this.getPriceTotal()):this.$message.success({message:i.message,duration:1500})})},handleRemove(s,t){if(s.productType=="custom"){const e=this.$createElement;let i=this.elementContentList.portal_cart_msg2||this.$t("cart.msg2"),c=this.elementContentList.portal_cart_msg3||this.$t("cart.msg3"),a=this.elementContentList.portal_btns_remove||this.$t("btns.remove"),r=this.elementContentList.portal_btns_cancel||this.$t("btns.cancel");this.$msgbox({message:e("div",null,[e("p",{style:"font-size: 16px;font-weight: 500;line-height: 24px;margin-bottom:8px;"},i),e("p",null,c)]),cancelButtonClass:"cancel_btn",confirmButtonClass:"confirm_btn",showCancelButton:!0,confirmButtonText:a,cancelButtonText:r,type:"warning"}).then(()=>{u(s.id).then(n=>{n.code==200&&(this.cartList.splice(t,1),this.$message.success({message:this.elementContentList.portal_cart_msg1||this.$t("cart.msg1"),duration:1500}),this.$store.dispatch("UpdateCartNum"))})}).catch(()=>{})}else u(s.id).then(e=>{e.code==200&&(this.cartList.splice(t,1),this.$message.success({message:this.elementContentList.portal_cart_msg1||this.$t("cart.msg1"),duration:1500}),this.$store.dispatch("UpdateCartNum"))})}}};var $=function(){var t=this,e=t._self._c;return e("div",{staticClass:"shopping_cart"},[e("div",{staticClass:"cart"},[e("h1",[t._v(t._s(t.elementContentList.portal_cart_text1||t.$t("cart.text1")))]),e("div",{staticClass:"cart_main"},[t.cartList.length>0?e("div",{staticClass:"cart_list"},t._l(t.cartList,function(i,c){return e("div",{key:c+"c",staticClass:"cart_item"},[i.productType=="normal"?e("div",{staticClass:"item"},[e("div",{staticClass:"flex"},[e("el-checkbox",{on:{change:t.handleChange},model:{value:i.check,callback:function(a){t.$set(i,"check",a)},expression:"item.check"}})],1),e("div",{staticClass:"pro_img"},[e("img",{attrs:{src:i.productPicUrl}})]),e("div",{staticClass:"pro_detail"},[e("p",{staticClass:"pro_title"},[t._v(t._s(i.productName))]),t._l(i.attributeValueVOs,function(a){return e("p",{key:a.productAttributeUid,staticClass:"pro_style"},[t._v(" "+t._s(a.productAttributeName)+": "),e("span",[t._v(t._s(a.value))])])}),e("p",{staticClass:"quantity"},[e("span",[t._v(t._s(t.elementContentList.portal_cart_text4||t.$t("cart.text4")))]),e("el-input",{on:{input:function(a){return t.handleInput(c,i)}},model:{value:i.quantity,callback:function(a){t.$set(i,"quantity",a)},expression:"item.quantity"}}),e("el-button",{staticClass:"btn btn3",attrs:{icon:"el-icon-arrow-up"},on:{click:function(a){return t.handleAddNum(c,i)}}}),e("el-button",{staticClass:"btn btn2",attrs:{icon:"el-icon-arrow-down"},on:{click:function(a){return t.handleMinusNum(c,i)}}})],1)],2),e("div",{staticClass:"price"},[e("p",[t._v("£ "+t._s(i.priceTotal))]),e("div",[e("span",{staticClass:"edit",on:{click:function(a){return t.handleEdit(i,c)}}},[t._v(t._s(t.elementContentList.portal_btns_edit||t.$t("btns.edit")))]),e("span",{on:{click:function(a){return t.handleRemove(i,c)}}},[t._v(t._s(t.elementContentList.portal_btns_remove||t.$t("btns.remove")))])])])]):t._e(),i.productType=="package"?e("div",{staticClass:"item"},[e("div",{staticClass:"flex"},[e("el-checkbox",{on:{change:t.handleChange},model:{value:i.check,callback:function(a){t.$set(i,"check",a)},expression:"item.check"}})],1),e("div",{staticClass:"pro_img"},[e("img",{attrs:{src:i.productPicUrl}})]),e("div",{staticClass:"pro_detail"},[e("p",{staticClass:"pro_title"},[t._v(t._s(i.productName))]),t._l(i.packageProductVOList,function(a){return e("div",{key:a.packageProductSkuUid,staticClass:"pro_package"},[e("div",{staticClass:"pack_item flex_b_c"},[e("div",{staticClass:"flex"},[e("div",{staticClass:"pack_img"},[e("img",{attrs:{src:a.productSkuStockThumbnail}})]),e("div",[e("span",[t._v(t._s(a.packageProductName+":"))]),t._l(a.attributeValueVOs,function(r,n){return e("span",{key:r.productAttributeUid},[t._v(t._s(r.value+(n==a.attributeValueVOs.length-1?"":",")))])})],2)]),e("div",[t._v(t._s("x"+a.num))])])])}),e("p",{staticClass:"quantity"},[e("span",[t._v(t._s(t.elementContentList.portal_cart_text4||t.$t("cart.text4")))]),e("el-input",{on:{input:function(a){return t.handleInput(c)}},model:{value:i.quantity,callback:function(a){t.$set(i,"quantity",a)},expression:"item.quantity"}}),e("el-button",{staticClass:"btn btn3",attrs:{icon:"el-icon-arrow-up"},on:{click:function(a){return t.handleAddNum(c)}}}),e("el-button",{staticClass:"btn btn2",attrs:{icon:"el-icon-arrow-down"},on:{click:function(a){return t.handleMinusNum(c)}}})],1)],2),e("div",{staticClass:"price"},[e("p",[t._v("£ "+t._s(i.priceTotal))]),e("div",[e("span",{staticClass:"edit",on:{click:function(a){return t.handleEdit(i,c)}}},[t._v(t._s(t.elementContentList.portal_btns_edit||t.$t("btns.edit")))]),e("span",{on:{click:function(a){return t.handleRemove(i,c)}}},[t._v(t._s(t.elementContentList.portal_btns_remove||t.$t("btns.remove")))])])])]):t._e(),i.productType=="custom"?e("div",{staticClass:"item"},[e("div",{staticClass:"flex"},[e("el-checkbox",{on:{change:t.handleChange},model:{value:i.check,callback:function(a){t.$set(i,"check",a)},expression:"item.check"}})],1),t._m(0,!0),e("div",{staticClass:"pro_detail"},[e("p",{staticClass:"pro_title"},[t._v(t._s(i.productName))]),t._l(i.cartCusObjItemVOS,function(a){return e("p",{key:a.cartCusItemId,staticClass:"pro_style"},[e("span",{staticStyle:{"margin-right":"24px"}},[t._v(t._s(a.objNickname))]),e("span",{staticStyle:{"margin-right":"24px"}},[t._v(t._s((a.height?a.height+"cm":"")+(a.weight?a.weight+"kg":"")))]),e("span",{staticStyle:{"margin-right":"24px"}},[t._v(t._s(a.ratio))]),e("span",{staticStyle:{color:"#f6497f"}},[t._v("£ "+t._s(a.price))])])}),e("div",{staticClass:"pro_info"},[e("p",{on:{click:function(a){t.isOpen=!t.isOpen}}},[e("span",[t._v(t._s(t.elementContentList.portal_cart_text11||t.$t("cart.text11")))]),t.isOpen?e("i",{staticClass:"el-icon-arrow-up"}):e("i",{staticClass:"el-icon-arrow-down"})]),e("div",{directives:[{name:"show",rawName:"v-show",value:t.isOpen,expression:"isOpen"}],staticStyle:{"margin-top":"16px"}},t._l(i.cartCusServiceItemVOS,function(a){return e("div",{key:a.cartCusItemId,staticClass:"pro_item flex"},[e("div",{staticClass:"flex_c_c img"},[e("img",{attrs:{src:a.productPicUrl}})]),e("div",{staticClass:"pro_name"},[e("div",{staticClass:"name"},[t._v(t._s(a.productName))]),e("div",[e("span",[t._v(t._s("x "+a.quantity))]),e("span",{staticClass:"pro_price"},[t._v("£ "+t._s(a.price))])])])])}),0)])],2),e("div",{staticClass:"price"},[e("p",[t._v("£ "+t._s(i.priceTotal))]),e("div",[e("span",{on:{click:function(a){return t.handleRemove(i,c)}}},[t._v(t._s(t.elementContentList.portal_btns_remove||t.$t("btns.remove")))])])])]):t._e()])}),0):t._e(),t.cartList.length==0?e("div",{staticClass:"cart_list nodata flex_c_c"},[t._m(1),e("p",{staticStyle:{margin:"22px 0"}},[t._v(t._s("Shopping cart is empty"))])]):t._e(),e("div",{staticClass:"settlement"},[e("p",{staticClass:"subtotal"},[t._v(" "+t._s(t.elementContentList.portal_cart_text7||t.$t("cart.text7"))+" ("+t._s(t.subtotal)+t._s(t.elementContentList.portal_cart_text8||t.$t("cart.text8"))+") ")]),e("hr"),e("p",{staticClass:"price_total"},[t._v(" "+t._s(t.elementContentList.portal_cart_text9||t.$t("cart.text9"))+t._s(t.priceTotal)+" ")]),e("el-button",{staticClass:"checkout",attrs:{disabled:t.checkedList.length==0},on:{click:t.handleToCheckout}},[t._v(t._s(t.elementContentList.portal_cart_text10||t.$t("cart.text10")))])],1)])]),t.showProInfo?e("productInfo",{attrs:{productUid:t.productUid,productQuantity:t.productQuantity,productSKUDetail:t.productSKUDetail,index:t.index},on:{changeSKUUid:t.changeSKUUid}}):t._e()],1)},S=[function(){var s=this,t=s._self._c;return t("div",{staticClass:"pro_img flex_c_c",staticStyle:{background:"linear-gradient(0deg, #ffe0e0 2%, #ffdce9 100%)"}},[t("img",{staticStyle:{width:"120px",height:"120px"},attrs:{src:f}})])},function(){var s=this,t=s._self._c;return t("p",[t("img",{attrs:{src:C}})])}],V=_(L,$,S,!1,null,null);const w=V.exports;export{w as default};
